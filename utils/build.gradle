import java.util.regex.Pattern

apply plugin: 'java-library'
apply plugin: 'import-aar'

sourceCompatibility = "1.8"
targetCompatibility = "1.8"
version = '3.0.1'
def targetSdkVersion = 28

dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])

    Properties properties = new Properties()
    properties.load(project.rootProject.file('local.properties').newDataInputStream())
    def sdkDir = properties.getProperty('sdk.dir')

    if (isGradle3()) {
        compileOnly files("${sdkDir}/platforms/android-${targetSdkVersion}/android.jar")
    } else {
        project.dependencies.add("compileOnly", files("${sdkDir}/platforms/android-${targetSdkVersion}/android.jar"))
    }
    api 'com.squareup.okhttp3:okhttp:3.10.0'
}


private boolean isGradle3() {
    Pattern GRADLE_ACCEPTABLE_VERSIONS = Pattern.compile("4\\.\\d*|0\\.\\d*[1-9]\\d*\$")
    if (GRADLE_ACCEPTABLE_VERSIONS.matcher(project.getGradle().getGradleVersion()).matches()) {
        return true
    }
    return false
}

